\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{float}
\usepackage{subcaption}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{booktabs} % For prettier tables
\usepackage{siunitx}
\usepackage{amssymb}
\usepackage{subcaption}

% Set page margins
\geometry{a4paper, margin=1in}

% Set up code listing style
\lstset{
    basicstyle=\ttfamily,
    commentstyle=\colour{gray},
    keywordstyle=\colour{blue},
    stringstyle=\colour{red},
    showstringspaces=false,
    captionpos=b
}

\title{Image Analysis Coursework}
\author{Vishal Jain}
\date{\today}

\begin{document}
\section{Question 1 - Image Segmentation}
This question details the segmentation algorithms used to segment the required sections of the lung ct image, the noisy flowers and the coin images.
\subsection{Part A: Lung CT Image Segmentation}
This section details the segmentation algorithm of the Lung CT image shown in Figure \ref{fig:lung_ct_image}. The region to be segmented is the lung area, including all the nodules and tissue within. The image is taken from the LIDC-IDRI dataset \cite{lidc_idri}.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{../data/CT.png}
    \caption{Lung CT image from the LIDC-IDRI dataset.}
    \label{fig:lung_ct_image}
\end{figure}

\subsubsection{Image Characteristics}
The image shows a high contrast between the lungs and surrounding non lung tissue. This observation motivates a threshold based approach to segment the lung area. The nodules and tissue in the intra lung regions are of a much higher intensity than the lung tissue, as such it is appropriate supplement the thresholding step with additional morphological operations.

\subsubsection{Assumptions}
The algorithm assumes that after binarising the image via thresholding, the background makes up the largest connected component, with the left and right lungs being the next two largest. The algorithm also assumes that the nodules and tissue within the lung regions are fully enclosed and do not touch the border of the lung regions.

\subsubsection{Segmentation Algorithm}
\begin{itemize}
    \item \textbf{Binarise Image via Otsu Thresholding:} The image is thresholded using Otsu's threshold. This is a global thresholding method that maximises the inter-class variance of foreground and background. 
    \item \textbf{Connected Component Analysis:} The binary image is inverted to make the lung and background regions the foreground. The connected components of the inverted image are labelled using 8-connectivity. The second and third largest connected components are selected to recover the left and right lung regions. The connected components are selected based on their area. 
    \item \textbf{Binary Hole Filling} To recover the nodules and tissue within the lung regions, binary hole filling is performed. The algorithm fills holes in a binary image by inverting the image, labelling connected regions, and converting regions not connected to the border from background to foreground.
    \end{itemize}
    \begin{figure}[H]
        \centering
        \begin{subfigure}{.3\textwidth}
            \centering
            \includegraphics[width=\linewidth]{figs/q1a_binary.png}  % Replace with your image file
            \caption{}
            \label{fig:otsu_threshold}
        \end{subfigure}%
        \begin{subfigure}{.3\textwidth}
            \centering
            \includegraphics[width=\linewidth]{figs/q1a_largest_connected_components.png}  % Replace with your image file
            \caption{}
            \label{fig:connected_components}
        \end{subfigure}%
        \begin{subfigure}{.3\textwidth}
            \centering
            \includegraphics[width=\linewidth]{figs/q1a_filled_holes.png}  % Replace with your image file
            \caption{}
            \label{fig:filled_holes}
        \end{subfigure}
        \label{fig:segmentation_steps}
    \caption{Key steps in the segmentation of the lung CT image: (a) Binarisation using Otsu's threshold, (b) Mask inversion and selection of lung regions via connected component analysis, (c) Recovery of internal structures through binary hole filling.}
    \end{figure}
Note, this segmentation algorithm was also implemented from scratch. Relevant code can be found in \texttt{src/q1a\_from\_scratch.py} and \texttt{src/from\_scratch\_seg\_funcs.py}.
\subsubsection{Results}
The final segmentation of the lung CT image is shown in Figure \ref{fig:lung_ct_image} The segmentation clearly captures the relevant lung regions and all the nodules and tissues within.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{figs/q1a.png}
    \caption{Final segmentation of the lung CT image.}
    \label{fig:lung_ct_segmentation}
\end{figure}

\subsubsection{Discussion}
Figure \ref{fig:q1a_ambiguity} shows a potential ambiguous region in the segmentation. This region was segmented due to having a similar intensity as the lung tissue and being connected to lung tissue post Otsu thresholding. However, as this region could not be clearly identified as non lung tissue without additional context, it was kept in the final segmentation. This also highlights the limitations of thresholding based segmentation methods in identifying regions that are not clearly defined by intensity.
\begin{figure}[H]
    \centering
    \begin{subfigure}{.4\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1a_seg_w_bbox.png}  % Replace with your image file
        \caption{}
        \label{fig:q1a_seg_w_bbox}
    \end{subfigure}%
    \begin{subfigure}{.4\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1a_zoomed_region.png}  % Replace with your image file
        \caption{}
        \label{fig:q1a_zoomed_region}
    \end{subfigure}%
    \caption{Ambiguous region in the segmentation: (a) Segmentation with bounding box around the ambiguous region, (b) Zoomed in view of the ambiguous region.}
    \label{fig:q1a_ambiguity}
\end{figure}

\subsection{Part B: Noisy Flowers Image Segmentation}
This section details the segmentation algorithm of the noisy flowers image shown in Figure \ref{fig:flowers_image}. The region to be segmented are all the purple flower heads in the image.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{../data/noisy_flower.jpg}
    \caption{Noisy Flowers image.}
    \label{fig:flowers_image}
\end{figure}

\subsubsection{Image Characteristics}
The image features a type of noise that is typical to gaussian degradations. This was confirmed by applying a gaussian filter to each of the colour channels seperately in the image and observing that nearby pixel colours were more. This effect is shown in Figure \ref{fig:gaussian_noise_evidence}. 
\begin{figure}[H]
    \centering
    \begin{subfigure}{.4\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_patch.png}  % Replace with your image file
        \caption{}
        \label{fig:flower_patch}
    \end{subfigure}%
    \begin{subfigure}{.4\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_gauss_blurred_patch.png}  % Replace with your image file
        \caption{}
        \label{fig:gaussian_filtered_flower_patch}
    \end{subfigure}%
    \caption{Effect of Gaussian filtering on the colour channels of the noisy flowers image: (a) Cropped region of the noisy flowers image, (b) Cropped region after applying a Gaussian filter with standard deviation 1.}
    \label{fig:gaussian_noise_evidence}
\end{figure}
The purple flowers in \ref{fig:flowers_image}, except for the ones clearly in the foreground, are all roughly of the same shade of purple. There are two batches of purple flowers in the image, one large group down the middle and another smaller group along the upper left corner of the image. The purple flowers in the foreground have shadows on them making the bottom half of the flower darker than the top half. Due to the general uniformity in colours of the flower after denoising, a clustering type algorithm is appropriate for this image.

\subsubsection{Assumptions}
The main assumption made by this algorithm is in choosing the number of clusters. The number of clusters is chosen to be 5, which is chosen based on the number of distinct colours in the image. The green grass and stems, the orange flower heads, the purple flower heads, the white flower heads and the red flower heads.

\subsubsection{Segmentation Algorithm}
\begin{itemize}
    \item \textbf{Bilateral Gaussian Filtering:} First the image was denoised using a bilateral filter \cite{710815}. This filter was chosen for its ability to denoise while considering both spatial proximity and colour similarity, ideal for preserving flower head edges. A spatial standard deviation of 15 was chosen to allow for smoothing across the entire flower head regions, while a colour standard deviation of 1 ensures edge sharpness by only blending similarly coloured pixels. This approach effectively reduces noise without blurring distinct colour boundaries.
    \item \textbf{Conversion from RGB to LAB colour Space:} The image is converted from RGB to LAB colour space, which better approximates human vision by separating colour and luminance. This space enhances clustering accuracy because Euclidean distances more closely reflect perceptual differences, making it ideal for grouping similar colours like purple flower heads.
    \item \textbf{K-Means Clustering:} K-means clustering is applied to the LAB image. The number of clusters is chosen to be 5, based on the number of distinct colours in the image. The image is then segmented by assigning each pixel to the cluster with the closest centroid.
    \item \textbf{Select Purple Pixels} The cluster centre closest to the the LAB value of purple is chosen to be the desired cluster to represent the foreground. The image is binarised by setting all pixels not in this cluster to 0 and all pixels in this cluster to 1.
    \item \textbf{Denoise Segmentation via Morphological Opening} To remove small-scale noise from the mask while retaining the shape and size of the main flower heads, a morphological opening operation is applied. 
    \item \textbf{Remove Small Connected Components:} Finally to remove any left over noise, all connected components with an area less than 100 pixels are removed. The previous morphological opening step ensures the required thresholding does not remove any of the main flower heads.
\end{itemize}
\begin{figure}[H]
    \centering
    \begin{subfigure}{.45\textwidth}  % Adjusted to fit two figures per row
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_denoised.png}
        \caption{}
        \label{fig:denoised_flowers}
    \end{subfigure}%
    \begin{subfigure}{.45\textwidth}  % Adjusted to fit two figures per row
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_kmeans_mask.png}
        \caption{}
        \label{fig:kmeans_mask_flowers}
    \end{subfigure}
    \begin{subfigure}{.45\textwidth}  % New row, first column
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_kmeans_mask_post_opening.png}
        \caption{}
        \label{fig:kmeans_mask_post_opening_flowers}
    \end{subfigure}%
    \begin{subfigure}{.45\textwidth}  % New row, second column
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_mask_post_cnc_removal.png}
        \caption{}
        \label{fig:cnc_threshold_flowers}
    \end{subfigure}%
    \caption{Segmentation process for the noisy flowers image: (a) Image after denoising with a bilateral filtering, showing reduced colour noise while preserving edge details. (b) Result of applying K-means clustering to segment purple pixels. (c) Segmentation mask post morphological opening, illustrating reduced noise in the segmentation. (d) Final segmentation after removing small connected components, highlighting the refined segmentation of flower regions.}
    \label{fig:q1b_segmentation_steps}
\end{figure}

\subsubsection{Results}
The final segmentation of the noisy flowers image is shown in Figure \ref{fig:q1b_final_mask}. The segmentation clearly captures most of the purple flower heads in the main central bunch. It also captures some in the smaller bunch in the upper left corner. It is able to distinguish between the colours effectively, with some of the orange and red flowers in the purple group being excluded from the segmentation quite effectively as seen in figure \ref{fig:flowers_seg_zoomed}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figs/q1b_final_mask.png}
    \caption{Final segmentation of the noisy flowers image.}
    \label{fig:q1b_final_mask}
\end{figure}

% TODO: Think of a better colouring scheme for the bounding boxes, white is washing out the image.
\begin{figure}[H]
    \centering
    \begin{subfigure}[c]{.6\textwidth}  % Centered subfigure on the left
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_seg_w_good_bbox.png}
        \caption{}  % Caption for the left subfigure
        \label{fig:q1b_zoomed}
    \end{subfigure}%
    \begin{minipage}[c]{.35\textwidth}  % Centered minipage for the right subfigures
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{figs/q1b_zoomed_region1.png}
            \caption{}  % Caption for the upper right subfigure
            \label{fig:q1b_zoomed_bad}
        \end{subfigure}\\[1ex]  % Add some space between the subfigures
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{figs/q1b_zoomed_region2.png}
            \caption{}  % Caption for the lower right subfigure
            \label{fig:q1b_zoomed_bad2}
        \end{subfigure}
    \end{minipage}
    \caption{Zoomed in view of the segmentation: (a) Segmentation with bounding boxs around regions of interest where the segmentation has performed well, (b) Zoomed in view of the segmentation showing the exclusion of orange flower from the purple group, (c) Zoomed in view of the segmentation showing the exclusion of orange and red flowers that are occluded by flowers from the purple group.}
    \label{fig:flowers_seg_zoomed}
\end{figure}

\subsubsection{Discussion}
The main challenge in this segmentation is the segmentation of the purple flower heads that are in the foreground (closest to the camera). These flower heads have shadows on them, making the bottom half of the flower darker than the top half, making them difficult to fully segment with the current approach. An example such case is shown in figure \ref{fig:q1b_seg_lim}. This highlights the limitations of a segmentation algorithm which segments purely on colour. A potential improvement to this algorithm would be to consider spatial shape based information to better segment these flower heads or make use of more sophisticated pre-processing to remove the shadows.
% TODO: Make it clearer where the seg is failing, right now the masks are not showing in the zoomed regions so not obvious
\begin{figure}[H]
    \centering
    \begin{subfigure}{.8\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_seg_w_bad_bbox.png}
        \caption{}  % Optional: add a specific caption here if needed.
        \label{fig:q1b_bad_seg_w_bbox}
    \end{subfigure}\\ % Add a line break to stack the next subfigure below
    \begin{subfigure}{.8\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1b_bad_zoomed_region.png}
        \caption{}  % Optional: add a specific caption here if needed.
        \label{fig:q1b_bad_zoom}
    \end{subfigure}
    \caption{Limitations in segmentation of noisy flowers image: (a) Full view of the image with poorly segmented areas highlighted in a bounding box, demonstrating where the algorithm fails to accurately segment due to shadows. (b) Close-up view of a poorly segmented area, showing flower heads which feature strong shadows, impacting segmentation accuracy.}
    \label{fig:q1b_seg_lim}
\end{figure}

\subsection{Part C: Coin Image Segmentation}
This section details the segmentation algorithm of the coin image shown in Figure \ref{fig:coins_image}. The region to be segmented are the first coin in the first row, the second coin in the second row, the third coin in the third row and the fourth coin in the fourth row.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{../data/coins.png}
    \caption{Coin image.}
    \label{fig:coins_image}
\end{figure}

\subsubsection{Image Characteristics}
The image has been degraded with vertical line type artefacts. These artefacts have likely been synthetically generated and can be corrected by filtering. There is generally good contrast between the coins and the background, however fig \ref{fig:otsu_threshold_coins}, applying an otsu threshold reveals that the coins in the first row are not clearly separated from the background. Edge detection to segment the coins is likely to perform better in this case.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{figs/q1c_otsu_thresholded.png}  % Replace with your image file
    \caption{Effect of Otsu thresholding on the coin image.}
    \label{fig:otsu_threshold_coins}
\end{figure}

\subsubsection{Assumptions}
To select the required coins for the task, the algorithm assumes that the coins are arranged in 4 rows with 6 columns, without making prior assumptions on what coin belongs to which position in the grid. The algorithm also assumes that the coins are not touching each other. Lastly, it assumes that the background is the largest connected component in the image.
\subsubsection{Segmentation Algorithm}

\begin{itemize}
\item \textbf{Row-wise Median Filtering:} Initially, a row-wise median filter is applied to the image to remove vertical line artefacts. This step is crucial to recover high quality edges for subsequent edge detection.
\item \textbf{Edge Detection with Canny:} Canny edge detection is a multi-stage algorithm that uses Gaussian smoothing to reduce noise, then detects edges by identifying areas with high gradient magnitudes. It employs a double threshold to classify edges into strong, weak, and non-edges: strong edges exceed the high threshold and are confirmed as true edges; weak edges between the two thresholds are only confirmed if connected to strong edges; and areas below the low threshold are dismissed as non-edges. This method ensures robust edge continuity and noise suppression.
\item \textbf{Dilation of Edges:} After detecting edges, a dilation operation is performed using an elliptical structuring element. This step helps to close small gaps in the detected edges, which aids in forming continuous outlines for the coins.
\item \textbf{Removal of the Largest Component:} The resulting image is then inverted and connected components are labelled. The largest connected component is assumed to be the background and is removed.
\item \textbf{Integration of Edges and Mask:} Edges detected from the Canny step are added to the mask of coins to enhance the definitions of the coins' borders and 'close' the coins so that the mask is more faithful to the actual coin shapes.
\item \textbf{Binary Hole Filling:} A binary hole filling operation is then performed to fill any unsegmented areas within each coin. 
\item \textbf{Median Filtering on Mask:} Finally, to remove spurious regions of the mask which arose from edges that did not belong to any coins, both row-wise and column-wise median filtering is applied to the mask. This step removes regions that are not part of the coins. This step ensures that the next step of removing small components need not require too large a threshold, risking the removal of actual coins.
\item \textbf{Removal of Small Connected Components:} Finally, any small connected components with an area less than 100 pixels are removed from the mask. This step ensures that only the coins are retained in the final mask.
\item \textbf{Sorting and Assigning Grid Positions:} The centroids of the coin masks are then sorted based on their vertical and horizontal coordinates to assign each coin a grid position. 
\item \textbf{Selecting Specific Coins:} The coins whose grid position matches the required positions are selected.

\end{itemize}

\begin{figure}[H]
    \centering
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_init_median_filtered.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_canny_edges.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_dilated_inverted_edges.png}
        \caption{}
    \end{subfigure}%

    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_connected_components.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_mask_no_bg.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_mask_edges.png}
        \caption{}
    \end{subfigure}%

    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_binary_hole_filled.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_median_filtered_mask.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.33\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_mask_no_small_components.png}
        \caption{}
    \end{subfigure}%

    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_identified_coins.png}
        \caption{}
    \end{subfigure}%
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q1c_selected_coins.png}
        \caption{}
    \end{subfigure}%
    
    \caption{Detailed steps of the coin segmentation process including: (a) Initial median filtering to remove line artefacts, (b) Canny edge detection to outline the coins, (c) Dilated edges to enhance edge continuity, (d) Identification of connected components to identify background, (e) Mask after background removal, (f) Mask integrated with edges to refine the coin outlines, (g) Binary hole filling to complete the interior of the coins, (h) Median filtered mask to remove spurious edges, (i) Final segmentation after eliminating small connected components to isolate individual coins, (j) Identified coins with their grid positions, (k) Selected coins based on specified positions.}
    \label{fig:coin_segmentation_steps}
\end{figure}

\subsubsection{Results}
The final segmentation of the coin image is shown in Figure \ref{fig:q1c_selected_coins}. The segmentation clearly captures the required coins in the specified grid positions.  

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figs/q1c.png}
    \caption{Final segmentation of the coin image.}
    \label{fig:q1c_selected_coins}
\end{figure}

\subsubsection{Discussion}
The chosen method works almost perfectly, the only issue is that the median filtering and edge dilation steps can result in the final mask being slightly unfaithful to the actual coin shapes around the edge. However, with more experimentation the current approach could be improved to better capture the coin shapes.

\section{Question 2 - Inverse Problems and Multi-resolution analysis}
\subsection{Part A - Inverse Problems}
% Introduce the problem in 2a: y = Ax + b, as a common inverse problem. Line fitting based on some noisy measurements of the line is an example of such a problem.
\subsubsection{Motivation}
In many scientific and engineering contexts, problems can be modelled as a linear system of equations, expressed as 
\[
y = Ax + b,
\]
where:
\begin{itemize}
    \item \(y\) is the vector of measurements,
    \item \(x\) represents the unknown vector of the underlying signal or model parameters.
    \item \(A\) is the system matrix that defines how measurements \(y\) relate to the signal / parameter vector \(x\).
    \item \(b\) is the (typically unknown) vector representing noise or measurement errors.
\end{itemize}

The challenge lies in recovering the unknown vector \(x\) from the measurements \(y\). However, such systems are rarely well-posed; it is not possible to invert the matrix \(A\) and obtain a unique solution. It is more typically for these systems to fall into the categories of being either over-determined, with more measurements than unknowns, or under-determined, with more unknowns than measurements.

In such cases, finding a solution involves minimising an objective function that quantifies the error between the observed measurements and those predicted by the model. This process is complemented by incorporating regularisation terms, which are required to find a unique solution in the under determined regime. 

\subsubsection{Problem Set Up}
In this scenario, the goal is to fit a line described by the equation \( y = ax + c \) to a dataset consisting of noisy measurements. This is a typical example of a linear inverse problem where we aim to determine the parameters of a line, which in matrix terms can be framed as:
\[
y = Ax + b.
\]
Here:
\begin{itemize}
    \item \(y\) is the vector of observed \(y\)-coordinates from the dataset, representing the outputs or dependent variables.
    \item \(A\) is the system matrix that incorporates the independent variable data. For each measurement pair \((x_i, y_i)\), the matrix \(A\) contains a row \([x_i, 1]\) to account for the slope and the intercept of the line.
    \item \(x\) is the vector of parameters to be estimated, specifically \([a, c]\), where \(a\) is the slope and \(c\) is the intercept of the line.
    \item \(b\) represents the vector of measurement errors.
\end{itemize}
This linear regression problem is tackled for two datasets describing noisy line measurements. Both datasets are depicted in Figure \ref{fig:line_fitting_data}, illustrating the points used for line fitting. It is worth noting that the second dataset is identical to the first for all points except for one which is modified to describe an outlier point. 

This system is over-determined for the given datasets because there are more measurements (\(20\) pairs of \(x, y\) values) than there are parameters to estimate (just two, \(a\) and \(c\)). Although over-determined systems may be well posed and have a unique solution and when all measurements are consistent with the true signal. However, in the presence of noise, the system will not have any exact solutions, where all data points lie perfectly on the same line. Instead, the objective is to find the best estimates for the parameters \(x = [a, c]\) that minimise the difference between the predicted line \( Ax \) and the observed data \( y \), via the objective function. In this problem, the \(L_2\) and \(L_1\) norms of the error vector, $\epsilon = y - Ax$, are explored as the objective functions. 


\begin{figure}[H]
    \centering
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q2a_noisy_line.png}
        \caption{}
        \label{fig:line_data_1}
    \end{subfigure}%
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q2a_noisy_line_outlier.png}
        \caption{}
        \label{fig:line_data_2}
    \end{subfigure}%
    \caption{Two datasets describing noisy measurements of points along a line: (a) Dataset 1 - line data with noisy observations (b) Dataset 2 - line data with noisy observations and a single outlier.}
    \label{fig:line_fitting_data}
\end{figure}
% Describe the method used to solve the problem in 2a
\subsubsection{Results}
To minimise the objective function for the given datasets, the \texttt{minimize} function from the \texttt{scipy.optimize} library is employed. This function uses the SLSQP optimisation algorithm to find the minimum of the objective function \cite{Kraft1988}. The results of the line fitting for the two datasets are shown in Figure \ref{fig:line_fitting_results} and the estimated line parameters are summarised in Table \ref{tab:line_fitting_results}.

\begin{figure}[H]
    \centering
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q2a_fitted_line_1.png}
        \caption{}
        \label{fig:line_fit_1}
    \end{subfigure}%
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figs/q2a_fitted_line_2.png}
        \caption{}
        \label{fig:line_fit_2}
    \end{subfigure}%
    \caption{Results of line fitting using the SLSQP optimization algorithm to minimise the \(L_2\) and \(L_1\) error norms for the two datasets, which are shown in green and orange respectively: (a) Dataset 1, (b) Dataset 2 with the outlier.}
    \label{fig:line_fitting_results}
\end{figure}

\begin{table}[H]
    \centering
    \begin{tabular}{@{}llll@{}}
    \toprule
    \textbf{Dataset} & \textbf{Objective Function} & \textbf{Slope (a)} & \textbf{Intercept (c)} \\ \midrule
    1               & \(L_2\) Norm                & 0.0665             & 0.2172                 \\
                    & \(L_1\) Norm                & 0.0663             & 0.2429                 \\ \midrule
    2               & \(L_2\) Norm                & 0.0462             & 0.5804                 \\
                    & \(L_1\) Norm                & 0.0662             & 0.2458                 \\ \bottomrule
    \end{tabular}
    \caption{Summary of the estimated line parameters for the two datasets using the \(L_2\) and \(L_1\) error norms.}
    \label{tab:line_fitting_results}
\end{table}

\subsubsection{Discussion}
In the absence of outliers, both \(L_2\) and \(L_1\) norms provide comparable results for line fitting, indicating a robust estimation of parameters under normal noise conditions. However, when outliers are present, the \(L_1\) norm offers a more accurate estimation because it minimises the absolute errors, which reduces the impact of extreme values. Conversely, the \(L_2\) norm, which minimises the sum of squared errors, gives disproportionately high weight to outliers. This sensitivity causes the \(L_2\) norm to be more influenced by the outlier, skewing the line fit significantly away from the majority of the data points, as observed in the results for the second dataset.
% Discuss the results of the problem in 2a - basically shows how l1 is more robust to outlier noise.

\subsection{Part B - Compressed Sensing Reconstruction}

\subsection{Part C - Multi-resolution Analysis}
% Describe the concept of a compressible signal and an image maybe sparse in the wavelet domain.

% Describe wavelet transform briefly and then introduce the plot

% Explain the plot

% Plot sho
% Introduce the idea of wavelet represnetation of an image
% Show the wavelet transform of the image, thresholded for top 15% of coefficients
% Explain the image.
% Show the reconstructions of the image from the thresholded coefficients at varying levels.
% Explain what this means.


\bibliographystyle{plain}  % Choose the style that suits your needs
\bibliography{references}  % The filename of the .bib file, without the extension
\end{document}